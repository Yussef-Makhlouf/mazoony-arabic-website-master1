# دليل اختبار نظام المصادقة والبريد الإلكتروني

## 🎯 النظام الحقيقي 100%

### 1. قاعدة البيانات
- النظام يعمل **فقط** مع MongoDB الحقيقية
- **لا يوجد** نظام وهمي أو للتجربة
- جميع البيانات تُحفظ وتُسترجَع من قاعدة البيانات

### 2. إعدادات البريد الإلكتروني
- تم إزالة المسافات من كلمة المرور: `hxigwtmkxdxtvqdy`
- تم تحديث الإعدادات الافتراضية في الكود

## 🧪 خطوات الاختبار

### الخطوة 1: تأكد من إعدادات البيئة
```bash
# قاعدة البيانات
MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/database

# البريد الإلكتروني
EMAIL_USER=yussef.ali.it@gmail.com
EMAIL_APP_PASSWORD=hxigwtmkxdxtvqdy
JWT_SECRET=mazoony-super-secret-jwt-key-for-development-testing-2024
NEXTAUTH_URL=http://localhost:3000
```

### الخطوة 2: تأكد من تشغيل قاعدة البيانات
- تأكد من أن MongoDB Atlas يعمل
- تحقق من صحة `MONGODB_URI`
- تأكد من وجود المستخدمين في قاعدة البيانات

### الخطوة 3: تشغيل الخادم
الخادم يعمل الآن على: http://localhost:3000

### الخطوة 4: اختبار الصفحات

#### 🔐 تسجيل الدخول:
1. اذهب إلى: http://localhost:3000/login
2. استخدم بيانات المستخدمين الموجودة في قاعدة البيانات
3. **لا توجد بيانات وهمية** - يجب إنشاء مستخدمين حقيقيين

#### 🔑 نسيان كلمة المرور:
1. اذهب إلى: http://localhost:3000/forgot-password
2. أدخل بريد إلكتروني موجود في قاعدة البيانات
3. **سيتم إرسال بريد إلكتروني حقيقي** مع رمز الاستعادة

#### 🔄 إعادة تعيين كلمة المرور:
1. اضغط على الرابط المُرسل في البريد الإلكتروني
2. أدخل كلمة مرور جديدة
3. أكد كلمة المرور

## 📧 اختبار البريد الإلكتروني

### البرید المُرسل سيحتوي على:
- ✅ رابط إعادة تعيين كلمة المرور
- ✅ تصميم عربي احترافي
- ✅ تحذيرات أمنية (صالح لـ 15 دقيقة)
- ✅ رابط احتياطي
- ✅ معلومات الموقع

### إذا لم يصل البريد:
1. تحقق من مجلد البريد المزعج
2. تأكد من صحة كلمة مرور التطبيق
3. راجع Console للأخطاء
4. تأكد من إعدادات SMTP

## 🔍 مراقبة الأخطاء

### في Console ستجد:
```
✅ تم إرسال البريد الإلكتروني بنجاح: <message-id>
✅ تم تحديث كلمة المرور بنجاح
```

### إذا فشل البريد الإلكتروني:
```
❌ خطأ في إرسال البريد الإلكتروني: [تفاصيل الخطأ]
```

### إذا فشلت قاعدة البيانات:
```
❌ خطأ في الاتصال بقاعدة البيانات: [تفاصيل الخطأ]
```

## 🎨 الميزات المتاحة

### الصفحات الجديدة:
1. **`/login`** - تسجيل دخول أنيق
2. **`/forgot-password`** - نسيان كلمة المرور
3. **`/reset-password`** - إعادة تعيين كلمة المرور

## 🚀 إعداد قاعدة البيانات

### إنشاء مستخدمين جدد:
1. استخدم MongoDB Compass أو Atlas
2. أضف مستخدمين في مجموعة `users`
3. تأكد من تشفير كلمات المرور
4. حدد الأدوار والصلاحيات

### هيكل المستخدم:
```javascript
{
  _id: ObjectId,
  name: "اسم المستخدم",
  email: "user@example.com",
  password: "كلمة مرور مشفرة",
  role: "admin" | "user",
  permissions: ["*"],
  isActive: true,
  createdAt: Date,
  updatedAt: Date
}
```

## ✅ النظام الآن يعمل 100% حقيقي!

- 🔐 تسجيل الدخول يعمل مع قاعدة البيانات الحقيقية
- 📧 إرسال البريد الإلكتروني يعمل (حقيقي)
- 💾 جميع البيانات تُحفظ في MongoDB
- 🚫 لا يوجد نظام وهمي أو للتجربة
- 🔒 أمان كامل مع قاعدة البيانات

## ⚠️ ملاحظات مهمة

1. **يجب أن تكون قاعدة البيانات متاحة** قبل تشغيل النظام
2. **لا يمكن اختبار النظام** بدون قاعدة بيانات
3. **جميع المستخدمين** يجب إنشاؤهم في قاعدة البيانات
4. **النظام سيتوقف** إذا فشل الاتصال بقاعدة البيانات
